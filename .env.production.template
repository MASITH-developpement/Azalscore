# ============================================================
# AZALS - Configuration Production TEMPLATE
# ============================================================
# INSTRUCTIONS:
# 1. Copier ce fichier vers .env.production
# 2. Remplacer TOUS les placeholders ${...} par des valeurs réelles
# 3. NE JAMAIS committer .env.production dans Git
# 4. Utiliser un gestionnaire de secrets en production (Vault, AWS Secrets Manager, etc.)
# ============================================================

# ============================================================
# APPLICATION
# ============================================================
VERSION=0.5.0
ENVIRONMENT=production
AZALS_ENV=production
DEBUG=false
LOG_LEVEL=INFO
LOG_JSON=true

# ============================================================
# BASE DE DONNÉES POSTGRESQL
# ============================================================
POSTGRES_VERSION=15-alpine
POSTGRES_DB=azals
POSTGRES_USER=azals_user
# SECURITE: Générer avec: openssl rand -base64 32
POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
POSTGRES_BIND=127.0.0.1
POSTGRES_PORT=5432
# SECURITE: Le mot de passe doit correspondre à POSTGRES_PASSWORD
DATABASE_URL=postgresql+psycopg2://azals_user:${POSTGRES_PASSWORD}@postgres:5432/azals
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20

# ============================================================
# REDIS
# ============================================================
REDIS_VERSION=7-alpine
REDIS_BIND=127.0.0.1
REDIS_PORT=6379
REDIS_URL=redis://redis:6379/0
REDIS_MAXMEMORY=256mb
REDIS_TIMEOUT=5
REDIS_HEALTH_TIMEOUT=2

# ============================================================
# SECURITE
# ============================================================
# SECURITE: Générer avec: openssl rand -base64 64
SECRET_KEY=${SECRET_KEY}
# SECURITE: Générer avec: openssl rand -base64 64
BOOTSTRAP_SECRET=${BOOTSTRAP_SECRET}
# SECURITE: Générer une clé Fernet avec: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
ENCRYPTION_KEY=${ENCRYPTION_KEY}
# SECURITE: Utiliser uniquement des noms de domaine HTTPS, jamais d'IP
CORS_ORIGINS=https://azalscore.com,https://www.azalscore.com
CORS_MAX_AGE=3600

# ============================================================
# RATE LIMITING
# ============================================================
RATE_LIMIT_PER_MINUTE=100
AUTH_RATE_LIMIT_PER_MINUTE=5

# ============================================================
# TIMEOUTS
# ============================================================
API_TIMEOUT_MS=30000

# ============================================================
# APPLICATION URL
# ============================================================
APP_URL=https://azalscore.com
APP_DOMAIN=azalscore.com

# ============================================================
# NGINX
# ============================================================
NGINX_VERSION=alpine
NGINX_BIND=127.0.0.1
NGINX_HTTP_PORT=8080
NGINX_HTTPS_PORT=8443

# ============================================================
# PROMETHEUS
# ============================================================
PROMETHEUS_VERSION=v2.45.0
PROMETHEUS_BIND=127.0.0.1
PROMETHEUS_PORT=9090
PROMETHEUS_RETENTION=30d

# ============================================================
# GRAFANA
# ============================================================
GRAFANA_VERSION=10.0.0
GRAFANA_BIND=127.0.0.1
GRAFANA_PORT=3000
GRAFANA_USER=admin
# SECURITE: Mot de passe fort, min 16 caractères
GRAFANA_PASSWORD=${GRAFANA_PASSWORD}
GF_SECURITY_ADMIN_USER=admin
GF_SECURITY_ADMIN_PASSWORD=${GF_SECURITY_ADMIN_PASSWORD}
GF_USERS_ALLOW_SIGN_UP=false
GF_SERVER_ROOT_URL=https://grafana.azalscore.com/
GF_SERVER_SERVE_FROM_SUB_PATH=false

# ============================================================
# LOKI & PROMTAIL
# ============================================================
LOKI_VERSION=2.8.0
LOKI_BIND=127.0.0.1
LOKI_PORT=3100
PROMTAIL_VERSION=2.8.0

# ============================================================
# OPENAI (GPT - Architecte Cognitif)
# ============================================================
# SECURITE: Clé API OpenAI depuis https://platform.openai.com/api-keys
OPENAI_API_KEY=${OPENAI_API_KEY}

# ============================================================
# ANTHROPIC AI (Claude - Expert Technique)
# ============================================================
# SECURITE: Clé API Anthropic depuis https://console.anthropic.com/
ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}

# ============================================================
# STRIPE (Paiement)
# ============================================================
# SECURITE: Clés Stripe depuis https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=${STRIPE_SECRET_KEY}
STRIPE_PUBLISHABLE_KEY=${STRIPE_PUBLISHABLE_KEY}
STRIPE_WEBHOOK_SECRET=${STRIPE_WEBHOOK_SECRET}

# ============================================================
# SMTP (Email) - Brevo
# ============================================================
SMTP_HOST=smtp-relay.brevo.com
SMTP_PORT=587
SMTP_USER=${SMTP_USER}
SMTP_PASSWORD=${SMTP_PASSWORD}
SMTP_FROM="AZALSCORE <contact@masith.fr>"
SMTP_USE_SSL=false
SMTP_USE_TLS=true

# ============================================================
# BACKUP
# ============================================================
BACKUP_STORAGE_PATH=/app/backups

# ============================================================
# TENANT INITIAL (MASITH)
# ============================================================
MASITH_TENANT_ID=masith
MASITH_ADMIN_EMAIL=contact@masith.fr
# SECURITE: Mot de passe fort, min 12 caractères avec majuscules, chiffres et caractères spéciaux
MASITH_ADMIN_PASSWORD=${MASITH_ADMIN_PASSWORD}

# ============================================================
# GUNICORN (API Workers)
# ============================================================
GUNICORN_WORKERS=1
GUNICORN_THREADS=2

# ============================================================
# DOCKER RESOURCES - MEMORY LIMITS
# ============================================================
API_MEMORY_LIMIT=2G
API_MEMORY_RESERVATION=512M
POSTGRES_MEMORY_LIMIT=2G
POSTGRES_MEMORY_RESERVATION=512M
REDIS_MEMORY_LIMIT=512M
REDIS_MEMORY_RESERVATION=64M
FRONTEND_MEMORY_LIMIT=128M
FRONTEND_MEMORY_RESERVATION=32M
NGINX_MEMORY_LIMIT=256M
NGINX_MEMORY_RESERVATION=64M
PROMETHEUS_MEMORY_LIMIT=512M
PROMETHEUS_MEMORY_RESERVATION=128M
GRAFANA_MEMORY_LIMIT=256M
GRAFANA_MEMORY_RESERVATION=64M
LOKI_MEMORY_LIMIT=256M
LOKI_MEMORY_RESERVATION=64M
PROMTAIL_MEMORY_LIMIT=128M
PROMTAIL_MEMORY_RESERVATION=32M

# ============================================================
# LOGGING
# ============================================================
LOG_MAX_SIZE=100m
LOG_MAX_FILES=5
LOG_VERBOSE=true
LOG_REQUESTS=true
