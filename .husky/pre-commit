#!/usr/bin/env sh
#
# AZALSCORE Pre-commit Hook (AZA-FE-ENF)
# =======================================
# VÃ©rifie la conformitÃ© avant chaque commit
#

# Aller dans le rÃ©pertoire frontend
cd frontend || exit 1

echo "ğŸ” Running pre-commit checks (AZA-FE-ENF)..."

# 1. Lint-staged (ESLint + Prettier sur fichiers modifiÃ©s)
echo "ğŸ“ Running lint-staged..."
npx lint-staged || {
  echo "âŒ Lint-staged failed"
  exit 1
}

# 2. AZALSCORE Linter (AZA-FE-ENF)
echo "ğŸ” Running AZALSCORE normative linter..."
npm run azalscore:lint || {
  echo "âŒ AZALSCORE linter failed - Violations AZA-FE-ENF detected"
  echo "ğŸ’¡ Fix violations before committing"
  exit 1
}

# 3. Validation structure modules
echo "ğŸ“‚ Validating module structure..."
npm run validate:modules || {
  echo "âŒ Module structure validation failed"
  exit 1
}

# 4. Validation meta.ts (AZA-FE-META)
echo "ğŸ“‹ Validating meta.ts files..."
npm run validate:meta || {
  echo "âŒ meta.ts validation failed"
  echo "ğŸ’¡ Run: npm run generate:meta"
  exit 1
}

echo "âœ… All pre-commit checks passed (AZA-FE-ENF)"
exit 0
